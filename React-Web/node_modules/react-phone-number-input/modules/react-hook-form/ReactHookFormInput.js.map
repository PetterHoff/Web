{"version":3,"file":"ReactHookFormInput.js","names":["React","useCallback","useImperativeHandle","Controller","PropTypes","useExternalRef","ReactHookFormInput","_ref","externalRef","Component","name","defaultValue","shouldUnregister","control","rules","onChange_","onChange","onBlur_","onBlur","rest","_objectWithoutProperties","_excluded","_useExternalRef","_useExternalRef2","_slicedToArray","internalRef","refPassthrough","undefined","renderInputComponent","_ref2","ref","restReactHookFormControlledFieldProps","_excluded2","focus","current","onChangeCombined","value","onBlurCombined","event","createElement","_extends","onFocus","render","props","field","forwardRef","propTypes","elementType","isRequired","string","bool","object","func"],"sources":["../../source/react-hook-form/ReactHookFormInput.js"],"sourcesContent":["import React, { useCallback, useImperativeHandle } from 'react'\r\nimport { Controller } from 'react-hook-form'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport useExternalRef from '../useExternalRef.js'\r\n\r\nlet ReactHookFormInput = ({\r\n  Component,\r\n  name,\r\n  defaultValue,\r\n  shouldUnregister,\r\n  control,\r\n  rules,\r\n  onChange: onChange_,\r\n  onBlur: onBlur_,\r\n  ...rest\r\n}, externalRef) => {\r\n  const [internalRef, refPassthrough] = useExternalRef(externalRef)\r\n\r\n  // `feact-hook-form` doesn't know how to properly handle `undefined` values.\r\n  // https://github.com/react-hook-form/react-hook-form/issues/2990\r\n  defaultValue = defaultValue === undefined ? null : defaultValue\r\n\r\n  const renderInputComponent = ({\r\n    ref,\r\n    onChange,\r\n    onBlur,\r\n    // `restReactHookFormControlledFieldProps` contain properties like `name` and `value`.\r\n    // https://github.com/react-hook-form/react-hook-form/blob/b0e6c3057ac12a7b12d5616aecf3791acb7d7204/src/types/controller.ts#L21-L30\r\n    ...restReactHookFormControlledFieldProps\r\n  }) => {\r\n    // Setting `ref` passed by `react-hook-form` results in a bug:\r\n    // when an initial value is defined (example: \"+78005553535\")\r\n    // it seems to be set directly on the `ref`d `<input/>`\r\n    // by `react-hook-form` and the result is a non-formatted\r\n    // \"+78005553535\" initial value in the `<input/>`.\r\n    //\r\n    // To work around that bug, a fake `ref` is assigned,\r\n    // so that it could only `.focus()` it and no more.\r\n    //\r\n    // `useImperativeHandle()` hook seems to allow `ref` being `undefined`.\r\n    //\r\n    // if (ref) {\r\n      useImperativeHandle(ref, () => ({\r\n        focus() {\r\n          internalRef.current.focus()\r\n        }\r\n      }))\r\n    // }\r\n\r\n    // This function may not work correctly when `defaultValues` are set for the input\r\n    // and the user clears the input value manually: the default value may re-appear as a result.\r\n    // https://github.com/catamphetamine/react-phone-number-input/issues/405#issuecomment-1295885201\r\n    const onChangeCombined = useCallback((value) => {\r\n      // `react-hook-form` doesn't know how to properly handle `undefined` values.\r\n      // https://github.com/react-hook-form/react-hook-form/issues/2990\r\n      if (value === undefined) {\r\n        value = null\r\n      }\r\n      onChange(value)\r\n      if (onChange_) {\r\n        onChange_(value)\r\n      }\r\n    }, [\r\n      onChange,\r\n      onChange_\r\n    ])\r\n\r\n    const onBlurCombined = useCallback((event) => {\r\n      onBlur(event)\r\n      if (onBlur_) {\r\n        onBlur_(event)\r\n      }\r\n    }, [\r\n      onBlur,\r\n      onBlur_\r\n    ])\r\n\r\n    return (\r\n      <Component\r\n        {...rest}\r\n        {...restReactHookFormControlledFieldProps}\r\n        ref={refPassthrough}\r\n        onChange={onChangeCombined}\r\n        onBlur={onBlurCombined}/>\r\n    )\r\n  }\r\n\r\n  // `react-hook-form@7` no longer accepts `onFocus` property.\r\n  // Since this component can be used with both `v6` and `v7`,\r\n  // the `onFocus` property is left here.\r\n  const onFocus = useCallback(() => {\r\n    // internalRef.current.disabled = false\r\n    internalRef.current.focus()\r\n  }, [])\r\n\r\n  return (\r\n    <Controller\r\n      control={control}\r\n      name={name}\r\n      defaultValue={defaultValue}\r\n      shouldUnregister={shouldUnregister}\r\n      rules={rules}\r\n      onFocus={onFocus}\r\n      render={(props) => {\r\n        // Differentiate between `react-hook-form@6` and `react-hook-form@7`.\r\n        // https://react-hook-form.com/migrate-v6-to-v7/\r\n        // https://gitlab.com/catamphetamine/react-phone-number-input/-/issues/57\r\n        // `props` (before v7) and `props.fields` (in v7) contain properties like:\r\n        // `ref`, `name`, `value`, `onChange`, `onBlur`.\r\n        // https://github.com/react-hook-form/react-hook-form/blob/b0e6c3057ac12a7b12d5616aecf3791acb7d7204/src/types/controller.ts#L21-L30\r\n        return renderInputComponent(props.field || props)\r\n      }}/>\r\n  )\r\n}\r\n\r\nReactHookFormInput = React.forwardRef(ReactHookFormInput)\r\n\r\nReactHookFormInput.propTypes = {\r\n  Component: PropTypes.elementType.isRequired,\r\n  name: PropTypes.string.isRequired,\r\n  defaultValue: PropTypes.string,\r\n  // A quote from `react-hook-form`:\r\n  // Without `shouldUnregister: true`, an input value would be retained when input is removed.\r\n  // Setting `shouldUnregister: true` makes the form behave more closer to native.\r\n  shouldUnregister: PropTypes.bool,\r\n  // A developer should pass a `control` object that is returned from `useForm()` hook.\r\n  // Not required when using `<FormProvider/>`.\r\n  control: PropTypes.object,\r\n  rules: PropTypes.object,\r\n  onChange: PropTypes.func,\r\n  onBlur: PropTypes.func\r\n}\r\n\r\nexport default ReactHookFormInput"],"mappings":"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","ignoreList":[]}